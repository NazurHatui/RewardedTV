<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Admin Panel</title>
  <link rel="stylesheet" href="style.css"/>
</head>
<body>
  <header>
    <div class="logo">ADMIN</div>
    <nav>
      <a href="index.html">Back to Site</a>
    </nav>
  </header>
  <main class="container">
    <section id="login-section" class="card">
      <h2>Admin Login</h2>
      <input type="text" id="admin-user" placeholder="Username"/><br/>
      <input type="password" id="admin-pass" placeholder="Password"/><br/>
      <button id="admin-login-btn">Login</button>
    </section>
    <section id="panel-section" class="card" style="display:none;">
      <h2>User Management</h2>
      <table id="users-table">
        <thead><tr><th>User</th><th>Watched</th><th>Balance</th><th>Action</th></tr></thead>
        <tbody></tbody>
      </table>
    </section>
  </main>
  <script>
    const users = JSON.parse(localStorage.getItem("users") || "{}");
    function saveUsers() { localStorage.setItem("users", JSON.stringify(users)); }
    function loadUsers() {
      const tbody = document.querySelector("#users-table tbody");
      tbody.innerHTML = "";
      for (const u in users) {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${u}</td>
          <td><input data-user="${u}" data-field="watched" type="number" value="${users[u].watched}"></td>
          <td><input data-user="${u}" data-field="balance" type="number" step="0.01" value="${users[u].balance}"></td>
          <td><button data-user="${u}" class="save-btn">Save</button></td>
        `;
        tbody.appendChild(tr);
      }
      tbody.querySelectorAll(".save-btn").forEach(btn => btn.onclick = () => {
        const u = btn.dataset.user;
        const row = btn.closest("tr");
        users[u].watched = Number(row.querySelector("input[data-field='watched']").value);
        users[u].balance = Number(row.querySelector("input[data-field='balance']").value);
        saveUsers();
        alert("Updated " + u);
      });
    }
    document.getElementById("admin-login-btn").onclick = () => {
      const u = document.getElementById("admin-user").value;
      const p = document.getElementById("admin-pass").value;
      if (u === "Admin" && p === "Admin123") {
        document.getElementById("login-section").style.display = "none";
        document.getElementById("panel-section").style.display = "block";
        loadUsers();
      } else alert("Invalid credentials");
    };
  </script>
</body>
</html>
